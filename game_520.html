<!doctype html>
<html lang="zh-Hans">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ğŸ® æ‰¾å‡ºå”¯ä¸€ä¸åŒï¼ˆ10å…³ï½œå›é€€æœºåˆ¶ï¼‰</title>

  <style>
    body{
      margin:0; min-height:100vh;
      display:flex; align-items:center; justify-content:center;
      font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","PingFang SC","Microsoft YaHei",Arial;
      background:radial-gradient(circle at top,#ffffff,#ffe8ef,#ffd2e0);
      padding:22px;
    }
    .card{
      background:#fff;
      border-radius:18px;
      padding:22px 18px;
      max-width:580px;
      width:100%;
      text-align:center;
      box-shadow:0 16px 40px rgba(0,0,0,.15);
    }
    h1{ font-size:20px; margin:0 0 8px 0; }
    .sub{ font-size:13px; opacity:.75; line-height:1.5; }

    .row{
      display:flex; gap:10px;
      justify-content:center; flex-wrap:wrap;
      margin:12px 0 8px 0;
    }
    .stat{
      background:rgba(0,0,0,.06);
      padding:9px 12px;
      border-radius:12px;
      font-weight:900;
      min-width:160px;
    }

    .board{
      margin-top:12px;
      display:grid;
      grid-template-columns: repeat(5, 1fr);
      gap:10px;
    }

    .tile{
      border-radius:14px;
      border:2px solid rgba(255,137,150,.25);
      background:rgba(255,255,255,.96);
      padding:14px 0;
      font-size:22px;
      font-weight:900;
      cursor:pointer;
      user-select:none;
      box-shadow:0 10px 20px rgba(0,0,0,.07);
      transition: transform .08s ease, opacity .12s ease;
    }
    .tile:active{ transform: scale(.98); }
    .tile.disabled{ opacity:.35; cursor:not-allowed; }

    .toast{
      margin-top:10px;
      font-size:13px;
      font-weight:900;
      min-height:22px;
    }

    .hidden{ display:none; }

    .btn{
      margin-top:14px;
      width:100%;
      padding:14px;
      border-radius:14px;
      border:none;
      background:#FF8996;
      color:#fff;
      font-size:16px;
      font-weight:900;
      cursor:pointer;
    }

    .win{
      font-size:18px;
      font-weight:900;
      line-height:1.6;
      margin-top:8px;
    }
    .hint{
      margin-top:10px;
      font-size:12px;
      opacity:.65;
      line-height:1.5;
    }

    @media (max-width:420px){
      .board{ grid-template-columns: repeat(4, 1fr); }
      .stat{ min-width:140px; }
    }
  </style>
</head>

<body>
  <div class="card">
    <h1 id="title">ğŸ˜ˆ æ‰¾å‡ºå”¯ä¸€ä¸åŒï¼ˆ10å…³ï¼‰</h1>
    <div id="desc" class="sub">
      è§„åˆ™ï¼š<b>60 ç§’å†…è¿è¿‡ 10 å…³</b><br>
      æ¯å…³åªæœ‰ <b>1 ä¸ªä¸ä¸€æ ·</b>ã€‚ç‚¹é”™ä¼šæ‰£æ—¶é—´ ğŸ˜ˆ<br>
      <b>âš ï¸ ç¬¬ 7 å…³å¼€å§‹ï¼šç‚¹é”™ä¼šå›é€€åˆ°ç¬¬ 5 å…³</b>
    </div>

    <div class="row" id="stats">
      <div class="stat">âœ… å…³å¡ï¼š<span id="stage">1</span>/10</div>
      <div class="stat">â³ æ—¶é—´ï¼š<span id="time">60</span>s</div>
    </div>

    <div id="board" class="board"></div>
    <div id="toast" class="toast"></div>

    <div id="success" class="hidden">
      <div class="win">
        ğŸ‰ æ­å–œå®è´é€šå…³æˆåŠŸï¼<br>
        RM520 è¶…çº§å¤§å¥–å·²è§£é” ğŸ’—
      </div>
      <div class="hint">
      <br>
        
      </div>
    </div>

    <div id="fail" class="hidden">
      <div class="win">ğŸ˜­ æ—¶é—´åˆ°å•¦</div>
      <div class="hint">åˆ·æ–°é¡µé¢å†æŒ‘æˆ˜ä¸€æ¬¡ ğŸ˜†</div>
      <button class="btn" onclick="location.reload()">å†æ¥ä¸€æ¬¡</button>
    </div>
  </div>

  <script>
    const TOTAL_TIME = 60;
    const STAGES = 10;

    // å›é€€è§„åˆ™ï¼šä»ç¬¬ 7 å…³å¼€å§‹ï¼Œç‚¹é”™å›åˆ°ç¬¬ 5 å…³
    const FALLBACK_FROM = 7;
    const FALLBACK_TO = 5;

    // éš¾åº¦éšå…³å¡ä¸Šå‡
    function tilesFor(stage){
      if(stage <= 3) return 16;
      if(stage <= 6) return 20;
      if(stage <= 8) return 25;
      return 30;
    }
    function penaltyFor(stage){
      if(stage <= 3) return 4;
      if(stage <= 6) return 5;
      if(stage <= 8) return 6;
      return 7;
    }

    const pairs = [
      { same:"ğŸ˜", diff:"ğŸ˜¶" },
      { same:"ğŸ˜‘", diff:"ğŸ˜¶" },
      { same:"ğŸ¥º", diff:"ğŸ˜¢" },
      { same:"ğŸ™‚", diff:"ğŸ˜¶" },
      { same:"ğŸ±", diff:"ğŸ˜º" },
      { same:"ğŸ“", diff:"ğŸ" },
      { same:"â­ï¸", diff:"ğŸŒŸ" },
      { same:"ğŸŒ¹", diff:"ğŸŒ·" },
      { same:"ğŸ˜ˆ", diff:"ğŸ‘¿" },
      { same:"ğŸ”º", diff:"ğŸ”»" }
    ];

    let started=false, done=false;
    let timeLeft=TOTAL_TIME;
    let stage=1;
    let timer=null;
    let diffIndex=0;
    let currentTiles=tilesFor(stage);
    let currentPenalty=penaltyFor(stage);

    const boardEl=document.getElementById("board");
    const toastEl=document.getElementById("toast");
    const timeEl=document.getElementById("time");
    const stageEl=document.getElementById("stage");

    function startTimer(){
      timer=setInterval(()=>{
        timeLeft--;
        if(timeLeft<0) timeLeft=0;
        timeEl.textContent=timeLeft;
        if(timeLeft<=0){
          clearInterval(timer);
          if(!done) lose();
        }
      },1000);
    }

    function randInt(n){ return Math.floor(Math.random()*n); }

    function lockBoard(){
      document.querySelectorAll(".tile").forEach(t=>t.classList.add("disabled"));
    }

    function buildStage(){
      currentTiles = tilesFor(stage);
      currentPenalty = penaltyFor(stage);

      toastEl.textContent = `ç¬¬ ${stage} å…³ï¼šæ‰¾å‡ºä¸ä¸€æ ·çš„ï¼ˆç‚¹é”™æ‰£ ${currentPenalty}sï¼‰`;
      boardEl.innerHTML = "";

      const pair = pairs[(stage-1) % pairs.length];
      diffIndex = randInt(currentTiles);

      for(let i=0;i<currentTiles;i++){
        const btn=document.createElement("div");
        btn.className="tile";
        btn.textContent = (i===diffIndex) ? pair.diff : pair.same;
        btn.onclick=()=>pick(i);
        boardEl.appendChild(btn);
      }
    }

    function goToStage(n){
      stage = n;
      stageEl.textContent = stage;
      buildStage();
    }

    function pick(i){
      if(done) return;

      if(!started){
        started=true;
        startTimer();
      }

      if(i===diffIndex){
        lockBoard();
        toastEl.textContent="âœ… å¯¹äº†ï¼ä¸‹ä¸€å…³é©¬ä¸Šæ¥â€¦";
        setTimeout(()=>{
          if(stage>=STAGES){
            win();
          }else{
            goToStage(stage + 1);
          }
        },420);
      }else{
        // å…ˆæ‰£æ—¶é—´
        timeLeft = Math.max(0, timeLeft - currentPenalty);
        timeEl.textContent = timeLeft;

        // å›é€€æœºåˆ¶
        if(stage >= FALLBACK_FROM){
          toastEl.textContent = `ğŸ’¥ é”™ï¼æ‰£ ${currentPenalty}s + å›é€€åˆ°ç¬¬ ${FALLBACK_TO} å…³ ğŸ˜ˆ`;
          setTimeout(() => {
            if(timeLeft<=0){
              clearInterval(timer);
              lose();
            }else{
              goToStage(FALLBACK_TO);
            }
          }, 450);
        }else{
          toastEl.textContent = `âŒ é”™ï¼æ‰£ ${currentPenalty}s ğŸ˜ˆ`;
          if(timeLeft<=0){
            clearInterval(timer);
            lose();
          }
        }
      }
    }

    function win(){
      done=true;
      clearInterval(timer);
      boardEl.classList.add("hidden");
      document.getElementById("stats").classList.add("hidden");
      document.getElementById("desc").classList.add("hidden");
      document.getElementById("title").textContent="ğŸ‰ è§£é”æˆåŠŸ";
      toastEl.classList.add("hidden");
      document.getElementById("success").classList.remove("hidden");
    }

    function lose(){
      done=true;
      boardEl.classList.add("hidden");
      document.getElementById("stats").classList.add("hidden");
      toastEl.classList.add("hidden");
      document.getElementById("desc").classList.add("hidden");
      document.getElementById("title").textContent="ğŸ˜­ å¤±è´¥äº†";
      document.getElementById("fail").classList.remove("hidden");
    }

    buildStage();
  </script>
</body>
</html>