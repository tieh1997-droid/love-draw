<!doctype html>
<html lang="zh-Hans">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ğŸ® æ‰¾å‡ºçœŸçˆ±å¿ƒï¼ˆå›°éš¾ç‰ˆï¼‰</title>

  <style>
    body{
      margin:0; min-height:100vh;
      display:flex; align-items:center; justify-content:center;
      font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","PingFang SC","Microsoft YaHei",Arial;
      background:radial-gradient(circle at top,#ffffff,#ffe8ef,#ffd2e0);
      padding:22px;
    }
    .card{
      background:#fff;
      border-radius:18px;
      padding:22px 18px;
      max-width:520px;
      width:100%;
      text-align:center;
      box-shadow:0 16px 40px rgba(0,0,0,.15);
    }
    h1{ font-size:20px; margin:0 0 8px 0; }
    .sub{ font-size:13px; opacity:.75; line-height:1.5; }

    .row{
      display:flex;
      gap:10px;
      justify-content:center;
      flex-wrap:wrap;
      margin:12px 0 10px 0;
    }
    .stat{
      background:rgba(0,0,0,.06);
      padding:9px 12px;
      border-radius:12px;
      font-weight:900;
      min-width:160px;
    }

    .board{
      margin-top:12px;
      display:grid;
      grid-template-columns: repeat(5, 1fr);
      gap:10px;
    }

    .tile{
      border-radius:14px;
      border:2px solid rgba(255,137,150,.25);
      background:rgba(255,255,255,.96);
      padding:14px 0;
      font-size:22px;
      font-weight:900;
      cursor:pointer;
      user-select:none;
      box-shadow:0 10px 20px rgba(0,0,0,.07);
      transition: transform .08s ease, opacity .12s ease;
    }
    .tile:active{ transform: scale(.98); }
    .tile.disabled{ opacity:.35; cursor:not-allowed; }

    .toast{
      margin-top:10px;
      font-size:13px;
      font-weight:900;
      min-height:22px;
    }

    .hidden{ display:none; }

    .btn{
      margin-top:14px;
      width:100%;
      padding:14px;
      border-radius:14px;
      border:none;
      background:#FF8996;
      color:#fff;
      font-size:16px;
      font-weight:900;
      cursor:pointer;
    }

    .win{
      font-size:18px;
      font-weight:900;
      line-height:1.6;
      margin-top:8px;
    }
    .hint{
      margin-top:10px;
      font-size:12px;
      opacity:.65;
      line-height:1.5;
    }

    @media (max-width:420px){
      .board{ grid-template-columns: repeat(4, 1fr); }
      .stat{ min-width:140px; }
    }
  </style>
</head>

<body>
  <div class="card">
    <h1 id="title">ğŸ˜ˆ æ‰¾å‡ºçœŸçˆ±å¿ƒï¼ˆå›°éš¾ç‰ˆï¼‰</h1>
    <div id="desc" class="sub">
      è§„åˆ™ï¼š<b>60 ç§’å†…æ‰¾å‡º 10 ä¸ªçœŸçˆ±å¿ƒ ğŸ’—</b><br>
      æ¯ä¸€è½®åªæœ‰ 1 ä¸ªæ˜¯çœŸçš„ã€‚ç‚¹é”™<b>æ‰£ 4 ç§’</b> ğŸ˜ˆ
    </div>

    <div class="row" id="stats">
      <div class="stat">âœ… è¿›åº¦ï¼š<span id="round">0</span>/10</div>
      <div class="stat">â³ æ—¶é—´ï¼š<span id="time">60</span>s</div>
    </div>

    <div id="board" class="board"></div>
    <div id="toast" class="toast"></div>

    <div id="success" class="hidden">
      <div class="win">
        ğŸ‰ é€šå…³æˆåŠŸï¼<br>
        RM520 è¶…çº§å¤§å¥–å·²è§£é” ğŸ’—
      </div>
      <div class="hint">
        ğŸ‘‰ è¯·æŠŠè¿™ä¸€é¡µæˆªå›¾å‘ç»™æˆ‘<br>
        æˆ‘ç«‹åˆ»æŠŠ RM520 è½¬ç»™ä½  ğŸ˜˜
      </div>
    </div>

    <div id="fail" class="hidden">
      <div class="win">ğŸ˜­ æ—¶é—´åˆ°å•¦</div>
      <div class="hint">åˆ·æ–°é¡µé¢å†æŒ‘æˆ˜ä¸€æ¬¡ ğŸ˜†</div>
      <button class="btn" onclick="location.reload()">å†æ¥ä¸€æ¬¡</button>
    </div>
  </div>

  <script>
    // â€”â€”å›°éš¾å‚æ•°ï¼ˆä½ æƒ³æ›´éš¾æˆ‘ä¹Ÿèƒ½å†åŠ ï¼‰â€”â€”
    const TOTAL_TIME = 60;
    const NEED_ROUNDS = 10;  // åŸæœ¬ 6 -> 10
    const TILES = 20;        // åŸæœ¬ 12 -> 20
    const PENALTY = 4;       // åŸæœ¬ 2 -> 4

    let started = false;
    let done = false;
    let timeLeft = TOTAL_TIME;
    let round = 0;
    let timer = null;
    let realIndex = 0;

    const boardEl = document.getElementById("board");
    const toastEl = document.getElementById("toast");
    const timeEl = document.getElementById("time");
    const roundEl = document.getElementById("round");

    function startTimer(){
      timer = setInterval(() => {
        timeLeft--;
        if(timeLeft < 0) timeLeft = 0;
        timeEl.textContent = timeLeft;

        if(timeLeft <= 0){
          clearInterval(timer);
          if(!done) lose();
        }
      }, 1000);
    }

    function randInt(n){ return Math.floor(Math.random() * n); }

    // æ´—ç‰Œ
    function shuffle(arr){
      const a = arr.slice();
      for(let i=a.length-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [a[i],a[j]] = [a[j],a[i]];
      }
      return a;
    }

    function buildRound(){
      toastEl.textContent = "æ‰¾å‡ºçœŸæ­£çš„ ğŸ’—ï¼ˆåªæœ‰ 1 ä¸ªï¼‰";
      boardEl.innerHTML = "";

      // ç”Ÿæˆä¸€ç»„ç¬¦å·ï¼š1 ä¸ªçœŸçˆ±å¿ƒ + å…¶ä½™å‡çˆ±å¿ƒ
      const symbols = Array(TILES).fill("â¤ï¸");
      const truePos = randInt(TILES);
      symbols[truePos] = "ğŸ’—";

      // å†æ´—ç‰Œä¸€æ¬¡ï¼Œè®©ä½ç½®æ›´éšæœº
      const shuffled = shuffle(symbols);
      realIndex = shuffled.indexOf("ğŸ’—");

      for(let i=0; i<TILES; i++){
        const btn = document.createElement("div");
        btn.className = "tile";
        btn.textContent = shuffled[i];
        btn.onclick = () => pick(i);
        boardEl.appendChild(btn);
      }
    }

    function lockBoard(){
      document.querySelectorAll(".tile").forEach(t => t.classList.add("disabled"));
    }

    function pick(i){
      if(done) return;

      if(!started){
        started = true;
        startTimer();
      }

      if(i === realIndex){
        lockBoard();
        round++;
        roundEl.textContent = round;
        toastEl.textContent = "âœ… æŠ“åˆ°çœŸçˆ±å¿ƒï¼ä¸‹ä¸€è½®é©¬ä¸Šå¼€å§‹ï½";
        setTimeout(() => {
          if(round >= NEED_ROUNDS){
            win();
          }else{
            buildRound();
          }
        }, 380);
      }else{
        timeLeft = Math.max(0, timeLeft - PENALTY);
        timeEl.textContent = timeLeft;
        toastEl.textContent = `âŒ ä¸æ˜¯è¿™ä¸ªï¼æ‰£ ${PENALTY} ç§’ ğŸ˜ˆ`;
        if(timeLeft <= 0){
          clearInterval(timer);
          lose();
        }
      }
    }

    function win(){
      done = true;
      clearInterval(timer);
      boardEl.classList.add("hidden");
      document.getElementById("stats").classList.add("hidden");
      document.getElementById("desc").classList.add("hidden");
      document.getElementById("title").textContent = "ğŸ‰ è§£é”æˆåŠŸ";
      toastEl.classList.add("hidden");
      document.getElementById("success").classList.remove("hidden");
    }

    function lose(){
      done = true;
      boardEl.classList.add("hidden");
      document.getElementById("stats").classList.add("hidden");
      toastEl.classList.add("hidden");
      document.getElementById("desc").classList.add("hidden");
      document.getElementById("title").textContent = "ğŸ˜­ å¤±è´¥äº†";
      document.getElementById("fail").classList.remove("hidden");
    }

    buildRound();
  </script>
</body>
</html>